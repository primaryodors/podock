
# Example command:
# clear; make code; bin/interpreter test_script.po testdata/OR1D2.rotated.pdb

LOAD $arg2
ECHO "Loaded " $PDB

ECHO "Protein is " $PROTEIN ", a peptide of " %SEQLEN " residues."

LET &testing = 3.1416
LET %inttest = &testing
LET @test = [5,&testing,81] + [10,%inttest,67]
LET @test /= 2
LET @res174 = 174
ECHO @test " and " @res174

LET $msg = "TMR4 ends on residue " + %TMR4.e + " and TMR5 starts on residue " + %TMR5.s + "."
ECHO $msg

# 
# 
# ECHO "Testing equals " &testing
# ECHO "Int test equals " ~
# ECHO %inttest

# LET $testing = $SEQUENCE FROM %TMR4.e FOR 20
# ECHO $testing

SEARCH 1 %SEQLEN "MAYDRYVAIC" %maydryvaic
LET $maydryvaic = $SEQUENCE FROM %maydryvaic FOR 10
ECHO "Olfactory receptor motif " $maydryvaic " found at position " %maydryvaic "."

SEARCH %TMR4.e %TMR5.s "HFFCE" %hxxce
LET $testing = $SEQUENCE FROM %hxxce FOR 5
ECHO "EXR2 zinc-binding motif found at position " %hxxce ": " $testing "."

LET %sr = %hxxce - 2
LET %er = %hxxce + 9
# HELIX STRAIGHT %sr %er
ECHO "Making alpha helix of " %sr " - " %er "."
HELIX ALPHA %sr %er

LET &grass_is_riz = 18

# Going to want a better way to take averages.
LET %i = %TMR5.s
LET @5 = %i
LET %i ++
LET @5 += %i
LET %i ++
LET @5 += %i
LET %i ++
LET @5 += %i
LET %i ++
LET @5 /= 4
ECHO "TMR5 top: " @5
LET @5 += [0,&grass_is_riz,0]

LET %i = %TMR3.s
LET @3 = %i
LET %i ++
LET @3 += %i
LET %i ++
LET @3 += %i
LET %i ++
LET @3 += %i
LET %i ++
LET @3 /= 4
ECHO "TMR3 top: " @3
LET @3 += [0,&grass_is_riz,0]

# LET &difference = @3.y - @5.y
# LET @3 -= [0,&difference,0]
LET @3.y = @5.y
# Lift the TMR3 end 1 metric skosh higher.
LET @3.y += 3
# DUMP

ECHO "Aligning alpha helix to " @5 " - " @3
ALIGN %sr %er 4 @5 @3


LET %er1 = %er + 1
LET %shelfer = %TMR5.s - 1
ECHO "Straightening " %er1 " - " %shelfer
HELIX STRAIGHT %er1 %shelfer


LET &drop_shelf = 5
LET @5.y -= &drop_shelf
LET @3.y -= &drop_shelf
ECHO "Aligning shelf to " @3 " - " @5
ALIGN %er1 %shelfer 1 @3 @5


LET %csr = %TMR4.e + 1
# DUMP
ECHO "Reconnecting broken " %sr
CONNECT %csr %sr 500

LET $outfname = $PROTEIN
LET $outfname += ".scripted.pdb"
SAVE $outfname QUIT






